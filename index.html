<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PETIR V17 HYPER-PRO</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <audio id="alarmSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" preload="auto"></audio>

    <div id="loginOverlay" class="login-overlay">
        <div class="login-box glass-panel">
            <div class="login-header">
                <i class="fas fa-bolt fa-3x" style="color:#facc15;"></i>
                <h2>PETIR V17</h2>
                <p>HYPER-PRO MONITORING</p>
            </div>
            <input type="text" id="userid" placeholder="ID Operator">
            <input type="password" id="password" placeholder="Password">
            <button onclick="attemptLogin()" class="btn-login">LOGIN SYSTEM</button>
            <p id="loginError" class="error-msg"></p>
        </div>
    </div>

    <nav class="sidebar" id="sidebar">
        <div class="brand">
            <i class="fas fa-bolt" style="color:#facc15;"></i> <span>PETIR QC</span>
        </div>

        <div class="user-profile">
            <div class="avatar"><i class="fas fa-user-shield"></i></div>
            <div class="user-info">
                <h4 id="displayUser">Administrator</h4>
                <small id="sessionTime">00:00:00</small>
            </div>
        </div>

        <ul class="nav-links">
            <li class="nav-header">MAIN MENU</li>
            <li onclick="switchTab('dashboard')" class="active"><i class="fas fa-tv"></i> <span>Command Center</span></li>
            <li onclick="switchTab('simulation')"><i class="fas fa-microchip"></i> <span>AI Simulasi</span></li>
            
            <li class="nav-header">DATA & REPORT</li>
            <li onclick="toggleSubmenu('submenu-laporan')" class="has-submenu">
                <div style="display:flex; justify-content:space-between; width:100%">
                    <span><i class="fas fa-print"></i> Laporan Produksi</span>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
            </li>
            <ul id="submenu-laporan" class="submenu">
                <li onclick="showShiftPopup('pdf')"><i class="fas fa-file-pdf"></i> Laporan PDF (Resmi)</li>
                <li onclick="showShiftPopup('excel')"><i class="fas fa-file-excel"></i> Laporan Excel</li>
                <li onclick="exportCSV()"><i class="fas fa-file-csv"></i> Export Raw CSV</li>
            </ul>

            <li class="nav-header">SYSTEM</li>
            <li onclick="openSettings()"><i class="fas fa-cogs"></i> Konfigurasi Alat</li>
            <li onclick="toggleSound()" id="btnSound"><i class="fas fa-volume-mute"></i> <span>Suara Alarm: OFF</span></li>
            <li onclick="toggleFullscreen()"><i class="fas fa-expand"></i> <span>Kiosk Mode</span></li>
            <li onclick="toggleTheme()" id="themeBtn"><i class="fas fa-moon"></i> <span>Mode Gelap</span></li>
            <li onclick="logout()" style="color:#ef4444; margin-top:20px;"><i class="fas fa-power-off"></i> Shutdown</li>
        </ul>

        <div class="sys-health">
            <div class="ping-dot" id="connectionDot"></div>
            <div class="health-info">
                <span>System Status</span>
                <small id="connectionText">Initializing...</small>
            </div>
        </div>
    </nav>

    <main class="content">
        <div class="top-bar">
            <i class="fas fa-bars mobile-toggle" onclick="toggleSidebar()"></i>
            <div class="digital-clock" id="clock">--:--:--</div>
        </div>

        <div id="tab-dashboard" class="tab-content active">
            <div class="grid-container">
                <div class="card main-card glass" id="cardMid">
                    <div class="card-header">
                        <h3>SUHU PROSES (MID)</h3>
                        <span class="live-indicator"><i class="fas fa-circle"></i> LIVE</span>
                    </div>
                    <div class="gauge-display">
                        <div id="mainTemp" class="temp-big skeleton">--.-</div>
                        <span class="unit">°C</span>
                        <span id="trendMid" class="trend-indicator flat"><i class="fas fa-minus"></i></span>
                    </div>
                    <div id="sysStatus" class="status-pill skeleton-pill">Loading Data...</div>
                    <div id="configInfo" class="target-info">Target: --</div>
                </div>

                <div class="card chart-card glass">
                    <div class="card-header">
                        <h3>ANALISIS REAL-TIME</h3>
                        <div class="legend-box">
                            <span style="color:#38bdf8">● IN</span>
                            <span style="color:#facc15">● MID</span>
                            <span style="color:#ef4444">● OUT</span>
                        </div>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="liveChart"></canvas>
                    </div>
                </div>

                <div class="card stats-card glass">
                    <h3>PARAMETER ZONE</h3>
                    <div class="stat-row">
                        <span><i class="fas fa-arrow-right-to-bracket"></i> INPUT</span>
                        <div style="text-align:right;">
                            <strong id="valIn" class="val-small skeleton-text">--°</strong>
                            <small id="trendIn" class="trend-small">--</small>
                        </div>
                    </div>
                    <div class="stat-row">
                        <span><i class="fas fa-arrow-right-from-bracket"></i> OUTPUT</span>
                        <div style="text-align:right;">
                            <strong id="valOut" class="val-small skeleton-text">--°</strong>
                            <small id="trendOut" class="trend-small">--</small>
                        </div>
                    </div>
                    
                    <div class="maintenance-box">
                        <small>Engine Run Hours</small>
                        <div class="progress-bar"><div class="fill" id="maintBar" style="width:0%"></div></div>
                        <div class="maint-info">
                            <span id="maintHours">0 Jam</span>
                            <span style="color:#facc15">Next Service: 500 Jam</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-simulation" class="tab-content">
            <div class="card glass">
                <h2><i class="fas fa-brain"></i> AI Predictive Analysis</h2>
                <div class="sim-controls">
                    <div class="sim-row"><span>Suhu Aktual:</span> <strong id="simRealTemp" style="color:#facc15">-- °C</strong></div>
                    <input type="range" id="simSlider" min="-20" max="20" value="0" oninput="runSimulation()">
                    <div class="sim-row"><span>Offset Simulasi:</span> <strong id="simOffsetVal">+0 °C</strong></div>
                </div>
                <div class="sim-result" id="simResultBox">
                    <h1 id="simFinalTemp">-- °C</h1>
                    <p id="simStatus">Geser slider untuk memprediksi hasil penggorengan.</p>
                </div>
            </div>
        </div>

    </main>

    <div id="settingsOverlay" class="modal">
        <div class="modal-content glass">
            <h3><i class="fas fa-sliders-h"></i> KALIBRASI ALARM</h3>
            <div class="form-grid">
                <div><label>Batas Atas (High)</label><input type="number" id="inputHigh"></div>
                <div><label>Batas Bawah (Low)</label><input type="number" id="inputLow"></div>
            </div>
            <div class="btn-row">
                <button onclick="saveConfig()" class="btn-save">SIMPAN & SYNC CLOUD</button>
                <button onclick="closeSettings()" class="btn-cancel">BATAL</button>
            </div>
        </div>
    </div>

    <div id="shiftOverlay" class="modal">
        <div class="modal-content glass">
            <h3><i class="fas fa-file-export"></i> EXPORT DATA</h3>
            <p>Pilih rentang waktu laporan:</p>
            <div class="btn-grid">
                <button onclick="generateReport(5)" class="btn-opt">5 JAM</button>
                <button onclick="generateReport(8)" class="btn-opt">8 JAM (SHIFT)</button>
                <button onclick="generateReport(12)" class="btn-opt">12 JAM</button>
            </div>
            <button onclick="document.getElementById('shiftOverlay').style.display='none'" class="btn-cancel full-width">BATAL</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
